


<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Welcome to NNE &#8212; NNE  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=b4b06768" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script src="_static/documentation_options.js?v=8a448e45"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Welcome to NNE" href="home/home.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://nnehome.github.io">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
    <p class="title logo__title">NNE</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="home/home.html">
                         Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="code/code.html">
                         Code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact/contact.html">
                         Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="home/home.html">
                         Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="code/code.html">
                         Code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact/contact.html">
                         Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article"></div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<section id="welcome-to-nne">
<h1>Welcome to NNE<a class="headerlink" href="#welcome-to-nne" title="Link to this heading">#</a></h1>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This website describes the neural net estimator (NNE) to estimate structural models, as proposed
in Wei and Jiang (2023). It provides a computationally-light alternative to simulated maximum likelihood
or simulated method of moments. NNE is especially suitable for cases where many simulations are needed to
evaluate likelihood/moment functions.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="overview-of-nne">
<h2>Overview of NNE<a class="headerlink" href="#overview-of-nne" title="Link to this heading">#</a></h2>
<p>We write down a structural model: <span class="math notranslate nohighlight">\({y = g(x, ϵ; θ)}\)</span>. The goal of estimation is to obtain the parameter <span class="math notranslate nohighlight">\({θ}\)</span>
after observing the covariates <span class="math notranslate nohighlight">\({x}\)</span> and outcome <span class="math notranslate nohighlight">\({y: {y,x} → θ}\)</span>.</p>
<p>The key idea of NNE is to use neural nets to directly learn the mapping from data to parameters.
The graph below provides an overview of NNE.</p>
<div class="math notranslate nohighlight" id="equation-neural-net-training">
<span class="eqno">(1)<a class="headerlink" href="#equation-neural-net-training" title="Link to this equation">#</a></span>\[\begin{split}\begin{align*}
\text{train a } \text{neural net } f(\cdot)
\begin{cases}
\boldsymbol{\theta}^{(1)} \xrightarrow{\boldsymbol{g}(\boldsymbol{x}_{i},\boldsymbol{\varepsilon}_{i}^{(1)};\boldsymbol{\theta}^{(1)})} &amp; \{\boldsymbol{y}_{i}^{(1)},\boldsymbol{x}_{i}\}_{i=1}^{n} \xrightarrow{\text{moments}} \boldsymbol{m}^{(1)} \xrightarrow{\text{neural net}} \widehat{\boldsymbol{\theta}}^{(1)} \\
\boldsymbol{\theta}^{(2)} &amp; \{\boldsymbol{y}_{i}^{(2)},\boldsymbol{x}_{i}\}_{i=1}^{n} \xrightarrow{\text{moments}} \boldsymbol{m}^{(2)} \xrightarrow{\text{neural net}} \widehat{\boldsymbol{\theta}}^{(2)} \\
\vdots &amp; \vdots \\
\boldsymbol{\theta}^{(L)} &amp; \{\boldsymbol{y}_{i}^{(L)},\boldsymbol{x}_{i}\}_{i=1}^{n} \xrightarrow{\text{moments}} \boldsymbol{m}^{(L)} \xrightarrow{\text{neural net}} \widehat{\boldsymbol{\theta}}^{(L)}
\end{cases}
\end{align*}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-neural-net-application">
<span class="eqno">(2)<a class="headerlink" href="#equation-neural-net-application" title="Link to this equation">#</a></span>\[\begin{align*}
\text{apply } f(\cdot) \text{on real data}
\begin{cases}
\{\underbrace{\boldsymbol{y}_{i},\boldsymbol{x}_{i}}_{\text{real data}}\}_{i=1}^{n} \xrightarrow{\text{moments}} \boldsymbol{m} \xrightarrow{\text{neural net}} \underbrace{\widehat{\boldsymbol{\theta}}}_{\text{estimate}}
\end{cases}
\end{align*}\]</div>
<dl class="simple">
<dt>Notation:</dt><dd><p><span class="math notranslate nohighlight">\(\boldsymbol{\theta}^{(\ell)}\)</span> drawn from a space <span class="math notranslate nohighlight">\(\Theta\)</span>;
<span class="math notranslate nohighlight">\(\boldsymbol{y}_{i}=\boldsymbol{g}(\boldsymbol{x}_{i},\boldsymbol{\varepsilon}_{i};\boldsymbol{\theta})\)</span> a structural model;
<span class="math notranslate nohighlight">\(\boldsymbol{y}^{(\ell)}\)</span> simulated outcome;
<span class="math notranslate nohighlight">\(\boldsymbol{m}^{(\ell)}\)</span> simulated moments;
<span class="math notranslate nohighlight">\(\widehat{\boldsymbol{\theta}}\)</span> neural net prediction</p>
</dd>
</dl>
<ol class="arabic simple">
<li><p>We draw parameter values <span class="math notranslate nohighlight">\(\theta^{(l)}\)</span> uniformly from a parameter space <span class="math notranslate nohighlight">\(\Theta\)</span>. Using the structural model, we can generate the outcome <span class="math notranslate nohighlight">\(y^{(l)}\)</span> under <span class="math notranslate nohighlight">\(\theta^{(l)}\)</span>. After repeating this procedure a number of times, we get the corresponding datasets that are generated under a range of parameter values. These datasets form the basis of the training examples where we can use to learn the mapping from data to the “correct” parameter values.</p></li>
<li><p>To make training easier, we can summarize the data <span class="math notranslate nohighlight">\(\{y^{(l)}, x\}\)</span>  into data moments <span class="math notranslate nohighlight">\(m^{(l)}\)</span>.</p></li>
<li><p>The neural net takes the data moments as input and predicts the parameter value underlying that dataset.</p></li>
<li><p>Once the neural net is trained, we plug in the real data moments to obtain NNE estimates <span class="math notranslate nohighlight">\(\hat{\theta}\)</span>.</p></li>
</ol>
<p>The neural net can output “standard errors” in addition to point estimates. We establish that this neural net estimator (NNE)
converges to limited-information Bayesian posterior when the number of training datasets L is sufficiently large.
Besides the benefit of light computational cost, NNE is also robust to redundant moments, which is beneficial for cases where
there lacks clear guidance on moment choices from a theoretical perspective.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="data-format">
<h2>2) Data format<a class="headerlink" href="#data-format" title="Link to this heading">#</a></h2>
<p>Oraganize data into five arrays: <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, <code class="docutils literal notranslate"><span class="pre">Xc</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code>. Respectively: <code class="docutils literal notranslate"><span class="pre">Xp</span></code> stores product attributes; <code class="docutils literal notranslate"><span class="pre">Xa</span></code> stores advertising attributes; and <code class="docutils literal notranslate"><span class="pre">Xc</span></code> stores consumer attributes; <code class="docutils literal notranslate"><span class="pre">Y</span></code> stores search and purchase outcomes; <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code> identifies consumers.</p>
<p>In the example below, there are n=10,000 consumers (or search sessions) and each consumer has J=20 options for search. There are 2 product attributes, 1 advertising attribute, and 3 consumer attributes.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  whos Xp Xa Xc Y consumer_idx</span>

<span class="go">    Name               Size             Bytes         Class      Attributes</span>

<span class="go">    Xa                200000x1         1600000        double</span>
<span class="go">    Xc                 10000x3          240000        double</span>
<span class="go">    Xp                200000x2         3200000        double</span>
<span class="go">    consumer_idx      200000x1         1600000        double</span>
<span class="go">    Y                 200000x2         3200000        double</span>
</pre></div>
</div>
<p>Below previews the first rows of  <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code>. Variable <code class="docutils literal notranslate"><span class="pre">Y</span></code> has two columns; the 1st column indicates search and 2nd column indicates purchase. We see that the first consumer searched option 1, 3, 4, and 8. She bought option 3.</p>
<p><code class="docutils literal notranslate"><span class="pre">Xc</span></code>, not displayed here, has only 10,000 rows, same as the number of consumers.</p>
<p>If data did not feature advertising attributes, we’d let <code class="docutils literal notranslate"><span class="pre">Xa</span></code> be 200000 by 0 (i.e., empty). If no consumer attributes, we’d let <code class="docutils literal notranslate"><span class="pre">Xc</span></code> be 10000 by 0.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  table(consumer_idx, Y, Xp, Xa)</span>
<span class="go">ans = 200000×4 table</span>
<span class="go"> consumer_idx      Y             Xp          Xa</span>
<span class="go"> ____________    ______    ______________    __</span>
<span class="go">        1        1    0    4      0.67743    0</span>
<span class="go">        1        0    0    5       1.1052    0</span>
<span class="go">        1        1    1    1     -0.24542    0</span>
<span class="go">        1        1    0    5      0.78452    0</span>
<span class="go">        1        0    0    4      0.10519    0</span>
<span class="go">        1        0    0    5     0.068463    0</span>
<span class="go">        1        0    0    4      0.35691    1</span>
<span class="go">        1        1    0    5      0.61307    0</span>
<span class="go">        1        0    0    3       1.1809    1</span>
<span class="go">        1        0    0    5      0.91391    0</span>
<span class="go">        1        0    0    5     0.054537    0</span>
<span class="go">        1        0    0    3       1.0015    0</span>
<span class="go">        1        0    0    5      0.73938    0</span>
<span class="go">        1        0    0    3    -0.020808    0</span>
<span class="go">        1        0    0    5      0.23587    0</span>
<span class="go">        1        0    0    5      0.43236    1</span>
<span class="go">        1        0    0    5    -0.040968    0</span>
<span class="go">        1        0    0    5       0.4916    0</span>
<span class="go">        1        0    0    2      0.96498    0</span>
<span class="go">        1        0    0    2      0.46767    0</span>
<span class="go">        2        1    0    3      0.72159    1</span>
<span class="go">        2        0    0    5     -0.39847    0</span>
<span class="go">        2        0    0    5      0.73669    1</span>
<span class="go">      :            :             :           :</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="bootstrap-standard-errors">
<h2>3) Bootstrap standard errors<a class="headerlink" href="#bootstrap-standard-errors" title="Link to this heading">#</a></h2>
<p>The nne_estimate function has standard error calculation built in. Simply add <code class="docutils literal notranslate"><span class="pre">&quot;se</span> <span class="pre">=</span> <span class="pre">true&quot;</span></code> option as shown below. The output will include an additional column of standard errors. The calculation bootstraps 50 samples so execution time will be longer, but it can take advantage of parallel computing toolbox if installed.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt; result = nne_estimate(nne, Y, Xp, Xa, Xc, consumer_idx, se = true);</span>
<span class="go">&gt;&gt; result</span>
<span class="go">result = 8×3 table</span>

<span class="go">   name          val          se</span>
<span class="go">__________    _________    ________</span>
<span class="go">&quot;\alpha_0&quot;      -6.4546    0.071848</span>
<span class="go">&quot;\alpha_1&quot;     -0.11333    0.044997</span>
<span class="go">&quot;\eta_0&quot;          5.929    0.061318</span>
<span class="go">&quot;\eta_1&quot;      -0.048687    0.011513</span>
<span class="go">&quot;\eta_2&quot;        0.22004    0.029282</span>
<span class="go">&quot;\eta_3&quot;       0.052894    0.023437</span>
<span class="go">&quot;\beta_1&quot;       0.25836    0.004951</span>
<span class="go">&quot;\beta_2&quot;      -0.53811    0.011032</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

<footer class="bd-footer">
  <div class="bd-footer__inner bd-page-width">
    <div class="footer-items__start">    
        <div class="footer-item">
          <p>© Copyright 2023, <a href="https://sites.google.com/site/yanhaomaxwei/" target="_blank">Yanhao "Max" Wei</a>, 
                                <a href="https://jiangzhenling.com/" target="_blank">Zhenling Jiang </a>.</p>
    </div>                      
  </div>
</footer>

  </body>
</html>