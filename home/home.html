


<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Welcome to NNE &#8212; NNE  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=62e430d9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script src="../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'home/home';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Consumer search" href="../code_1/code_1.html" />
    <link rel="prev" title="Welcome to NNE" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://nnehome.github.io">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
    <p class="title logo__title">NNE</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                         [Home]
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../code_1/code_1.html">
                         [Consumer Search]
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../code_2/code_2.html">
                         [AR1 Model]
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                         [Home]
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../code_1/code_1.html">
                         [Consumer Search]
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../code_2/code_2.html">
                         [AR1 Model]
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Welcome to NNE</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="welcome-to-nne">
<span id="home"></span><h1>Welcome to NNE<a class="headerlink" href="#welcome-to-nne" title="Link to this heading">#</a></h1>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This website provides a guide and code of the neural net estimator (NNE) (<a class="reference external" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3496098#" rel="noopener noreferrer" target="_blank">Wei and Jiang 2023</a>). NNE exploits machine learning techniques to estimate existing econometric models. It can achieve good estimation accuracy at light computational costs, and thus provides an alternative to simulated maximum likelihood or simulated method of moments.</p>
<p>Below, we describe an <a class="reference internal" href="#overview">overview</a> of NNE, its <a class="reference internal" href="#step-by-step-procedure">step-by-step procedure</a>, and the <a class="reference internal" href="#applicability">applicability</a> to marketing/economics problems.</p>
<p>We also provide Matlab code for two applications of NNE. You’re welcome to modify the code to estimate other econometric models. You can find the code at this <a class="reference external" href="https://github.com/nnehome/nne-matlab" rel="noopener noreferrer" target="_blank">GitHub</a> repository. Please also find the documentation for the code at the <a class="reference internal" href="../code_1/code_1.html#code-1"><span class="std std-ref">consumer search</span></a> page and the <a class="reference internal" href="../code_2/code_2.html#code-2"><span class="std std-ref">AR1 model</span></a> page.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>A (structural) econometric model specifies some outcome of interest <span class="math notranslate nohighlight">\(\boldsymbol{y}\equiv\{y_i\}_{i=1}^{n}\)</span> as a function of some observed attributes <span class="math notranslate nohighlight">\(\boldsymbol{x}\equiv\{\boldsymbol{x}_i\}_{i=1}^{n}\)</span>  and some unobserved attributes <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span>. The function is often an economic model such as random utility maximization, sequential search, game, etc. The outcome of interest can be consumer choice, sales, etc. The observed attributes often are consumer and product characteristics.</p>
<p>So we can denote a structural econometric model as <span class="math notranslate nohighlight">\(\boldsymbol{y} = \boldsymbol{q}(\boldsymbol{x}, \boldsymbol{\epsilon},  \boldsymbol{\theta})\)</span>, where <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span> is the parameter of the model. The task of structural estimation can be described as recovering the parameter <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span> from data <span class="math notranslate nohighlight">\(\{\boldsymbol{x, y}\}\)</span>.</p>
<p>The basic idea of NNE is to train neural nets to recognize <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span> from data <span class="math notranslate nohighlight">\(\{\boldsymbol{x, y}\}\)</span>.</p>
<p>To train such a neural net, we only require it is possible to simulate <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> using the econometric model. Specifically, we first draw many different values of the parameter. Given each parameter value, use the structural model to generate a copy of data. Then, these many parameter values and their corresponding copies of data become the training examples for the neural net. The step-by-step procedure below gives more details.</p>
</section>
<section id="step-by-step-procedure">
<h2>Step-by-step Procedure<a class="headerlink" href="#step-by-step-procedure" title="Link to this heading">#</a></h2>
<p>Below we list the usual procedure of NNE. We use <span class="math notranslate nohighlight">\(\ell\)</span> to index the training examples that we use to train the neural net.</p>
<ol class="arabic simple">
<li><p><strong>Simulate data.</strong> For each <span class="math notranslate nohighlight">\(\ell\)</span>, draw parameter values <span class="math notranslate nohighlight">\(\boldsymbol{\theta}^{(\ell)}\)</span> from a parameter space <span class="math notranslate nohighlight">\(\Theta\)</span>. Use the structural econometric model to simulate a set of outcomes <span class="math notranslate nohighlight">\(\boldsymbol{y}^{(\ell)}\)</span>, under the parameter <span class="math notranslate nohighlight">\(\boldsymbol{\theta}^{(\ell)}\)</span> and the observed attributes <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span>.</p></li>
<li><p><strong>Summarize data.</strong> For each <span class="math notranslate nohighlight">\(\ell\)</span>, summarize the data <span class="math notranslate nohighlight">\(\{\boldsymbol{y}^{(\ell)}, \boldsymbol{x}\}\)</span> into a set of data moments <span class="math notranslate nohighlight">\(\boldsymbol{m}^{(\ell)}\)</span>.</p></li>
<li><p><strong>Train a neural net.</strong> Repeat step 1-3 for <span class="math notranslate nohighlight">\(\ell=1,...,L\)</span> to construct the training examples <span class="math notranslate nohighlight">\(\{\boldsymbol{m}^{(\ell)},\boldsymbol{\theta}^{(\ell)}\}_{\ell=1}^{L}\)</span>. We can also repeat these steps more times to create validation examples. Use these examples to train a neural net.</p></li>
<li><p><strong>Get the estimate.</strong> Plug the real data moments into the neural net to obtain an estimate of <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span>.</p></li>
</ol>
<p>Some practical notes:</p>
<ul class="simple">
<li><p>We specify <span class="math notranslate nohighlight">\(\Theta\)</span> so that it likely contains the true <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span>. If we have a prior, we may also draw <span class="math notranslate nohighlight">\(\boldsymbol{\theta}^{(\ell)}\)</span> from the prior distribution.</p></li>
<li><p>We specify <span class="math notranslate nohighlight">\(\boldsymbol{m}\)</span> so that it contains relevant information for recovering <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span>. Common examples include the mean of <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> and the covariances between <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span>. It is generally OK to include possibly irrelevant or redundant moments in <span class="math notranslate nohighlight">\(\boldsymbol{m}\)</span> – the performance of NNE is relatively robust to redundant moments.</p></li>
<li><p>We can use mean-square-error loss to train NNE. Other loss functions can train the neural net to give measures of statistical accuracy in addition to point estimates. See <a class="reference external" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3496098#" rel="noopener noreferrer" target="_blank">our paper</a> for details.</p></li>
</ul>
</section>
<section id="applicability">
<h2>Applicability<a class="headerlink" href="#applicability" title="Link to this heading">#</a></h2>
<p>The table below summarizes the main properties of NNE as well as its suitable applications.</p>
<p>The complexity of econometric models in economics/marketing means there is often no closed-form expressions of likelihood or moment functions. So reseachers often rely on simulation-based estimators such as simulated maximum likelihood (SMLE) and simulated method of moments (SMM). NNE is a simulation-based estimator like SMLE and SMM. But the properties of NNE offer sizable speed and accuracy gains over SMLE/SMM in some applications. One particular application in marketing that can benefit from NNE is consumer sequential search. We have studied it extensively in <a class="reference external" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3496098#" rel="noopener noreferrer" target="_blank">our paper</a>. You can find our code on the <a class="reference internal" href="../code_1/code_1.html#code-1"><span class="std std-ref">consumer search</span></a> page.</p>
<table class="table-header-centered table" id="main-properties-table">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 90.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Main Properties</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>It does not require computing integrals over the unobservables (<span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span>) in the structural econometric model. It only requires being able to simulate data using the econometric model.</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>It does not require optimizing an (potentially non-smooth) objective function as in extremum estimators (e.g., SMLE, SMM, indirect inference).</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>It is more robust to redundant moments when compared to SMM/GMM.</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>It computes a measure of statistical accuracy as a byproduct.</p></td>
</tr>
</tbody>
</table>
<table class="table-header-centered table">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Suitable Applications</p></th>
<th class="head"><p>Less Suitable Applications</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A large number of simulations are needed to evaluate likelihood/moments. The SMLE/SMM objective is difficult to optimize. There lacks clear guidance on moment choice. Formulas of standard errors are not yet established.</p></td>
<td><p>Closed-form expressions are available for likelihood/moments. The main estimation burden comes from other than the simulations to evaluate likelihood/moments.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Examples</strong>: discrete choices with rich unobserved heterogeneity, sequential search, choices on networks.</p></td>
<td><p><strong>Examples</strong>: dynamic choice or games where the main burden is solving policy functions.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

<footer class="bd-footer">
  <div class="bd-footer__inner bd-page-width">
    <div class="footer-items__start">    
        <div class="footer-item">
          <p>© Copyright 2023, <a href="https://sites.google.com/site/yanhaomaxwei/" target="_blank">Yanhao "Max" Wei</a>, 
                                <a href="https://jiangzhenling.com/" target="_blank">Zhenling Jiang </a>.</p>
    </div>                      
  </div>
</footer>

  </body>
</html>